<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Backbone Bootstrap Widgets</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    
    <script src="3rd/jquery.min.js" type="text/javascript"></script>
    <script src="3rd/bootstrap.min.js" type="text/javascript"></script>
    <link href="3rd/bootstrap.min.css" rel="stylesheet" type="text/css" charset="utf-8">
    
    <script src="3rd/underscore.js" type="text/javascript"></script>
    <script src="3rd/backbone.js" type="text/javascript"></script>
    
    <script src="src/backbone-form.js" type="text/javascript"></script>
    <script src="src/backbone-modal.js" type="text/javascript"></script>
    <script src="example.js" type="text/javascript"></script>
    
    <style>
      header.navbar-inverse {border-radius: 0;}
      footer.navbar-default {border-radius: 0; margin-bottom: 0;}
    </style>
  </head>
  <body>
    <header class="navbar navbar-inverse">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Backbone Bootstrap Widgets</a>
      </div>
      <div class="collapse navbar-collapse" id="navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="#FormView">FormView</a></li>
          <li><a href="#ModalView">ModalView</a></li>
        </ul>
      </div>
    </header>
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <p>
            Series of widgets implemented as <a href="http://backbonejs.org" target="_blank">Backbone</a> Views wrapping <a href="http://getbootstrap.com/javascript" target="_blank">Bootstrap plugins</a>.
          <p>
          <ul>
            <li><a href="#FormView">FormView</a> creates a <a href="http://backbonejs.org/#View" target="_blank">Backbone View</a> using <a href="http://getbootstrap.com/css/#forms" target="_blank">Bootstrap form</a> markup and styling. Implements bindings to update the <a href="http://backbonejs.org/#Model" target="_blank">Backbone Model</a> based on DOM changes made by the user.</li>
            <li><a href="#ModalView">ModalView</a> creates a <a href="http://backbonejs.org/#View" target="_blank">Backbone View</a> wrapping a <a href="http://getbootstrap.com/javascript/#modals" target="_blank">Bootstrap modal dialog</a>. You can fill in the moal body in the <code>render</code> function.</li>
          </ul>
        </div>
      </div>

      <!-- Backbone Form View -->
      <div class="row">
        <div class="col-md-12">
          <h1 id="FormView">Backbone.FormView</h1>
          <p>
            A FormView is a Backbone View which shows a form to edit the bound Backbone Model.
            Changes made by the user are directly applied back to the Backbone Model.
            FormView even supports nested objects.
          </p>
          <p>
            The form markup is that of <a href="http://getbootstrap.com/css/#forms" target="_blank">Bootstrap form</a>.
            The form uses the horizontal layout (class <code>form-horizontal</code>).
            Each model attribute is represented by a <code>control-group</code> DIV.
            Control types currently supported are text INPUT and SELECT.
          </p>
          <p>
            In addition to Backbone View options, FormView takes these extra options:
            <ul>
              <li><strong>schema</strong>: Schema defining which attributes to edit, and what controls to use. See below.</li>
              <li><strong>field</strong>: Optional. If set, will override default field options (see below).</li>
            </ul>
          </p>
          <p>
            Option <code>schema</code> defines which model attributes will be edited. The schema is a list of field objects.
            A field object consists of:
            <ul>
              <li><strong>name</strong>: Model attribute to edit.</li>
              <li><strong>nested</strong>: Optional. If the attribute is itslef an object, nested attribute name.</li>
              <li><strong>label</strong>: Label of field.</li>
              <li>
                <strong>control</strong>: Type of input control. Supported controls are:
                <ul>
                  <li><strong>input</strong>: Text INPUT.</li>
                  <li><strong>booleanInput</strong>: Single checkbox INPUT for Boolean fields. When checked, will set model attribute to true, false otherwise.</li>
                  <li><strong>uneditableInput</strong>: An uneditable input.</li>
                  <li><strong>select</strong>: SELECT. Set <strong>options</strong> to specific OPTION elements.</li>
                  <li><strong>radioInput</strong>: INPUT[TYPE=RADIO]. Set <strong>options</strong> to specific input elements.</li>
                  <li><strong>spacer</strong>: An empty space.</li>
                  <li><strong>textarea</strong>: TEXTAREA.</li>
                </ul>
              </li>
              <li><strong>type</strong>: Optional. Input type. Defaults to <code>text</code>.</li>
              <li><strong>disabled</strong>: Optional. Set to true to disabled the input or select.</li>
              <li><strong>options</strong>: Optional. For controls <strong>select</strong> and <strong>radioInput</strong>, list of option objects in the form: <code>{label:&lt;label&gt;, value:&lt;value&gt;}</code>.</li>
              <li><strong>placeholder</strong>: Optional. Placeholder for an input control.</li>
              <li><strong>className</strong>: Optional. Class to set on the <code>control-group</code> DIV.</li>
              <li><strong>labelClassName</strong>: Optional. Class to control the width of labels. Defaults to <code>col-sm-4</code>.</li>
              <li><strong>controlsClassName</strong>: Optional. Class to control the width of form controls. Defaults to <code>col-sm-8</code>.</li>
              <li><strong>controlClassName</strong>: Optional. Class to add to the input or select element.</li>
            </ul>
          </p>
          <h2>Size of form</h2>
          <p>
            Use Bootstrap column classes to control the size of the form labels and controls.
            By default labels use <code>col-sm-4</code> and controls <code>col-sm-8</code>.
            You can override this when you define the schma set setting <code>labelClassName</code> and <code>controlsClassName</code>.
          </p>
          <p>
            You can also set these globally by extending the default field definition. For example:
<pre>
var form = new Backbone.FormView({
  field: {
    labelClassName: "col-sm-2",
    controlsClassName: "col-sm-4"
  },
  ...
})
</pre>
          </p>
          <h2>Example</h2>
          <p>Form to edit a person. The address is a nested object. Change to see the Backbone model updated (right).</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <form id="form" class="form-horizontal"></form>
        </div>
        <div class="col-md-6">
          <pre id="object"></pre>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h2>Code</h2>
<pre>
var person = {
  id: 101,
  salutation: "Mr",
  firstName: "Andre",
  lastName: "Jones",
  adult: true,
  address: {
    address1: "1751 rue Richardson",
    address2: "Suite 3.105",
    city: "Montréal",
    postalCode: "H3K 1G6",
    province: "QC"
  }
};
var person = new Backbone.Model(person);
var form = new Backbone.FormView({
  el: "#form",
  model: person,
  schema: [
  {name: "id", label: "Id", control: "uneditableInput"},
  {name: "firstName", label: "First Name", control: "input"},
  {name: "lastName", label: "Last Name", control: "input"},
  {name: "adult", label: "Adult", control: "booleanInput"},
  {
    name: "salutation",
    label: "Salutation",
    control: "radioInput",
    options: [
      {label: "Mr.", value: "Mr"},
      {label: "Mrs.", value: "Mrs"},
      {label: "Mme.", value: "Mme"}
    ]
  },
  {control: "spacer"},
  {name: "address", nested: "address1", label: "Address1", control: "input"},
  {name: "address", nested: "address2", label: "Address2", control: "input"},
  {name: "address", nested: "city", label: "City", control: "input"},
  {name: "address", nested: "postalCode", label: "Postal Code", control: "input"},
  {
    name: "address",
    nested: "province",
    label: "Province",
    control: "select",
    options: [
      {label: "Alberta", value: "AB"},
      {label: "British Columbia", value: "BC"},
      {label: "Manitoba", value: "MB"},
      {label: "New Brunswick", value: "NB"},
      {label: "Newfoundland and Labrador", value: "NL"},
      {label: "Northwest Territories", value: "NT"},
      {label: "Nova Scotia", value: "NS"},
      {label: "Nunavut", value: "NU"},
      {label: "Ontario", value: "ON"},
      {label: "Prince Edward Island", value: "PE"},
      {label: "Québec", value: "QC"},
      {label: "Saskatchewan", value: "SK"},
      {label: "Yukon", value: "YT"}
    ]
  },
  {name: "lifeGoal", label: "Life goal", control: "textarea"}]
});
form.render();

function updateObject() {
  $("#object").text(JSON.stringify(person.toJSON(), null, 2));
}
person.on("change", updateObject);
updateObject();
</pre>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h2>Bootstrap 2.3</h2>
          <p>
            Backbone FormView is built for Bootstrap 3.
            To use Backbone FormView with Bootstrap 2.3, you must modify the HTML markups.
            In addition, we declare a new field option <code>inputSize</code> to control the size of controls.
            It takes possible values <code>min</code>, <code>small</code>, <code>medium</code>, <code>large</code>, <code>xlarge</code> or <code>xxlarge</code>. Defaults to <code>xlarge</code>.
            See <a href="http://getbootstrap.com/2.3.2/base-css.html#forms">Bootstrap 2.3 forms</a> for more information.
            Use this code.
          </p>
<pre>
Backbone.FormView.prototype.templates = {
  input: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;%-label%&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;input type="&lt;%=type%&gt;" class="input-&lt;%=inputSize%&gt; &lt;%=controlClassName%&gt;" name="&lt;%=name%&gt;" data-nested="&lt;%=nested%&gt;" value="&lt;%-value%&gt;" placeholder="&lt;%-placeholder%&gt;" /&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  booleanInput: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;label class="checkbox inline"&gt;',
    '      &lt;input type="checkbox" class="input-&lt;%=inputSize%&gt; &lt;%=controlClassName%&gt;" name="&lt;%=name%&gt;" data-nested="&lt;%=nested%&gt;" value="&lt;%-value%&gt;" /&gt; &lt;%-label%&gt;',
    '    &lt;/label&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  uneditableInput: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;%-label%&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;span class="uneditable-input input-&lt;%=inputSize%&gt; &lt;%=controlClassName%&gt;"&gt;&lt;%-value%&gt;&lt;/span&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  spacer: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&nbsp;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;&lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  select: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;%-label%&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;select class="input-&lt;%=inputSize%&gt; &lt;%=controlClassName%&gt;" name="&lt;%=name%&gt;" data-nested="&lt;%=nested%&gt;" value="&lt;%-value%&gt;" placeholder="&lt;%-placeholder%&gt;"&gt;',
    '      &lt;% for (var i=0; i &lt; options.length; i++) { %&gt;',
    '        &lt;% var option = options[i]; %&gt;',
    '        &lt;option value="&lt;%-option.value%&gt;" &lt;%=option.value == value ? "selected=\'selected\'" : ""%&gt;&gt;&lt;%-option.label%&gt;&lt;/option&gt;',
    '      &lt;% } %&gt;',
    '    &lt;/select&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  radioInput: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;%-label%&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;% for (var i=0; i &lt; options.length; i++) { %&gt;',
    '      &lt;% var option = options[i]; %&gt;',
    '      &lt;label class="radio inline"&gt;',
    '        &lt;input type="radio" class="form-control &lt;%=controlClassName%&gt;" name="&lt;%=name%&gt;" data-nested="&lt;%=nested%&gt;" value="&lt;%-option.value%&gt;" placeholder="&lt;%-placeholder%&gt;" /&gt;',
    '        &lt;%=option.label%&gt;',
    '      &lt;/label&gt;',
    '    &lt;% } %&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n")),
  textarea: _.template([
    '&lt;div class="control-group &lt;%=className%&gt;"&gt;',
    '  &lt;label class="control-label &lt;%=labelClassName%&gt;"&gt;&lt;%-label%&gt;&lt;/label&gt;',
    '  &lt;div class="controls &lt;%=controlsClassName%&gt;"&gt;',
    '    &lt;textarea class="input-&lt;%=inputSize%&gt; &lt;%=controlClassName%&gt;" name="&lt;%=name%&gt;" data-nested="&lt;%=nested%&gt;" placeholder="&lt;%-placeholder%&gt;"&gt;&lt;%-value%&gt;&lt;/textarea&gt;',
    '  &lt;/div&gt;',
    '&lt;/div&gt;'
  ].join("\n"))
};
Backbone.FormView.prototype.field.inputSize = "xlarge";
</pre>
        </div>
      </div>
      <br/>


      <!-- Backbone Form View -->
      <div class="row">
        <div class="col-md-12">
          <h1 id="ModalView">Backbone.ModalView</h1>
          <p>
            A ModalView is a Backbone View which shows a Bootstrap modal dialog upon calling <code>render</code>.
            After <code>render</code>, a <code>postRender</code> function is always called. You can subclass and implement the <code>postRender</code> function to fill in the body.
          </p>
          <p>
            Use Backbone View <code>events</code> to capture Bootstrap events and put callbacks on buttons. For example:
<pre>
events: {
  "click .modal-footer a": function(e) {console.log("Button " + $(e.target).text() + "cliked!");},
  "hidden.bs.modal": function() {console.log("Bootstrap modal is hidden!")}
}
</pre>
          </p>
          <p>Backbone ModalView supports these options:</p>
          <ul>
            <li><strong>title</strong>: Optional. HTML to put in the modal header. Defaults to &lt;h3&gt;Info&lt;/h3&gt;.</li>
            <li><strong>body</strong>: Optional. HTML to put im the modal body. Defaults to an empty string.</li>
            <li>
              <strong>buttons</strong>: Optional. List of buttons to show. Defaults to a Close button. A button is an anchor tag with Bootstrap class btn. Each button has these options:
              <ul>
                <li><strong>className</strong>: Optional. CSS classes to add. Defaults to empty string.</li>
                <li><strong>href</strong>: Optional. Anchor tag href. Defaults to #.</li>
                <li><strong>label</strong>: Optional. Button text. Defaults to Close.</li>
                <li><strong>close</strong>: Optional. Boolean indicating whether to close the dialog after the button is pressed. Defaults to false.</li>
              </ul>
            </li>
            <li><strong>backdrop</strong>: Optional. Specify if backdrop is existing. backdrop option can be boolean or 'static'. Defaults true. 'static' option avoid closing the modal on the click on the backdrop.</li>
          </ul>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h2>Examples</h2>
          <button id="btn-1" class="btn btn-primary">Basic modal dialog</button>
          &nbsp;
          <button id="btn-2" class="btn btn-primary">Subclassed modal dialog</button>
          &nbsp;
          <button id="btn-3" class="btn btn-primary">Static backdrop</button>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h2>Code</h2>
<pre>
// Basic modal dialog
$("#btn-1").click(function(e) {
  var modal = new Backbone.ModalView({
    body: "Hello World!"
  });
  modal.render();
});

// Modal dialog with custom buttons, events and postRender function
var MyModal = Backbone.ModalView.extend({
  title: "&lt;h3&gt;Modal with custom buttons&lt;/h3&gt;",
  buttons: [{
    className: "btn-primary ok",
    label: "Ok"
  }, {
    className: "btn-default cancel",
    label: "Cancel",
    close: true
  }],
  events: {
    "click .modal-footer a.ok": "onOk",
    "click .modal-footer a.cancel": "onCancel",
    "hidden.bs.modal": "onHidden"
  },
  postRender: function() {
    var $h4 = $("&lt;h4&gt;").text("Events"),
        $p = $("&lt;p&gt;").text("Use Backbone.View &lt;code&gt;events&lt;/code&gt; to bind buttons. Click on the buttons and look at the console.")
    this.$body.append($h4).append($p);
    return this;
  },
  onOk: function(e) {
    e.preventDefault();
    console.log("Ok clicked");
  },
  onCancel: function(e) {
    console.log("Cancel clicked");
  },
  onHidden: function(e) {
    console.log("Modal hidden");
  }
});
$("#btn-2").click(function(e) {
  new MyModal().render();
});

// Modal with static backdrop
// Work with Bootstrap 2.3 and 3
$("#btn-3").click(function(e) {
  var modal = new Backbone.ModalView({
    title: "Static backdrop",
    body: "Hello World!",
    backdrop: 'static'
  });
  modal.render();
});

</pre>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h2>Bootstrap 2.3</h2>
          <p>
            Backbone ModalView is built for Bootstrap 3.
            To use Backbone ModalView with Bootstrap 2.3, you must modify the HTML markups.
            See <a href="http://getbootstrap.com/2.3.2/javascript.html#modals">Bootstrap 2.3 modals</a> for more information.
            Use this code.
          </p>
<pre>
Backbone.ModalView.prototype.template = _.template([
  '&lt;div class="modal-header"&gt;',
  '  &lt;a type="button" class="close" aria-hidden="true"&gt;&times;&lt;/a&gt;',
  '  &lt;%=title%&gt;',
  '&lt;/div&gt;',
  '&lt;div class="modal-body"&gt;&lt;%=body%&gt;&lt;/div&gt;',
  '&lt;div class="modal-footer"&gt;&lt;/div&gt;'
].join("\n"));
Backbone.ModalView.prototype.className = "modal hide backbone-modal";
</pre>
        </div>
      </div>
      <br/>

    <br/>

    <footer class="navbar navbar-default">
        <p class="navbar-text navbar-left">&copy; 2014 <a href="http://www.amilia.com/en">Amilia Inc.</a> <a href="https://github.com/AmiliaApp/backgrid-object-cell/blob/gh-pages/LICENSE">Licensed under MIT.</a></p>
        <p class="navbar-text navbar-right">Written by <a href="http://martindrapeau.tumblr.com/">Martin Drapeau</a></p>
        <p class="navbar-text navbar-right">&nbsp;</p>
    </footer>
    <a href="https://github.com/AmiliaApp/backgrid-object-cell"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
</html>